example_mvp: str = "example_mvp.parquet"

"""
example_mvp.parquet (20, 4)
┌─────────────┬─────────────┬───────────────────┬────────────────────────┬───────────────┬────────────────────┬────────────────────┬────────────────────┬────────────────────┬────────────────────────┬───────┬─────────────────┐
│ column_name │ column_type │        min        │          max           │ approx_unique │        avg         │        std         │        q25         │        q50         │          q75           │ count │ null_percentage │
│   varchar   │   varchar   │      varchar      │        varchar         │     int64     │      varchar       │      varchar       │      varchar       │      varchar       │        varchar         │ int64 │  decimal(9,2)   │
├─────────────┼─────────────┼───────────────────┼────────────────────────┼───────────────┼────────────────────┼────────────────────┼────────────────────┼────────────────────┼────────────────────────┼───────┼─────────────────┤
│ cTail       │ VARCHAR     │ A1                │ Z                      │            15 │ NULL               │ NULL               │ NULL               │ NULL               │ NULL                   │    20 │            0.00 │
│ cDepth      │ UINTEGER    │ 0                 │ 3                      │             4 │ 1.3                │ 0.8645047258706176 │ 1                  │ 1                  │ 2                      │    20 │            0.00 │
│ user_value1 │ DOUBLE      │ 9.600000000000001 │ 9.9                    │             4 │ 9.72727272727273   │ 0.0786245393106891 │ 9.700000000000001  │ 9.700000000000001  │ 9.775                  │    20 │           45.00 │
│ user_value2 │ DOUBLE      │ 663113530824211.6 │ 1.7208435515317248e+16 │            20 │ 7553106919397770.0 │ 4653821326669313.0 │ 3418547926891442.5 │ 8525308671262186.0 │ 1.1118205530814776e+16 │    20 │            0.00 │
└─────────────┴─────────────┴───────────────────┴────────────────────────┴───────────────┴────────────────────┴────────────────────┴────────────────────┴────────────────────┴────────────────────────┴───────┴─────────────────┘

┌─────────┬────────┬───────────────────┬────────────────────────┐
│  cTail  │ cDepth │    user_value1    │      user_value2       │
│ varchar │ uint32 │      double       │         double         │
├─────────┼────────┼───────────────────┼────────────────────────┤
│ A1      │      0 │              NULL │     4433021920397551.5 │
│ B       │      1 │              NULL │      663113530824211.6 │
│ C       │      2 │ 9.700000000000001 │ 1.1602477287697392e+16 │
│ D       │      2 │ 9.700000000000001 │     4523479929846451.0 │
│ E       │      1 │              NULL │     1785059155888482.2 │
│ F       │      2 │ 9.700000000000001 │     8610132418777669.0 │
│ G       │      2 │ 9.700000000000001 │ 1.7208435515317248e+16 │
│ A2      │      0 │              NULL │ 1.3663814735625294e+16 │
│ E       │      1 │              NULL │     3190232449575444.0 │
│ E       │      2 │ 9.700000000000001 │     8595718552375203.0 │
│ G       │      2 │              NULL │     3201171678032007.0 │
│ C       │      3 │ 9.600000000000001 │     3635924175750878.0 │
│ B       │      1 │               9.8 │ 1.2150902473689224e+16 │
│ Z       │      0 │               9.9 │  1.063393377393216e+16 │
│ Y       │      0 │              NULL │     5500682402888033.0 │
│ V       │      1 │              NULL │     8615506271043085.0 │
│ V       │      2 │ 9.700000000000001 │     1771945185112145.8 │
│ W       │      1 │               9.8 │     9244145388597298.0 │
│ X       │      1 │              NULL │ 1.3577542752436462e+16 │
│ X       │      2 │ 9.700000000000001 │     8454898790149170.0 │
├─────────┴────────┴───────────────────┴────────────────────────┤
│ 20 rows                                             4 columns │
└───────────────────────────────────────────────────────────────┘

┌─────────┬─────────┬─────────┬─────────┬─────────┬─────────┬────────┬────────┬────────┬────────┬────────┬────────┬─────────┬─────────┬────────┬────────┬───────────────────┬────────────────────────┬────────────────────┬────────────────────┬────────────────────┬────────────────────┬────────────────────┐
│ v000_3  │ v001_3  │ v002_3  │ v003_3  │  cHead  │  cTail  │ cDepth │ cStart │ cStop  │ cWidth │  cOut  │ cSize  │ cIsRoot │ cIsLeaf │ cLeft  │ cRight │    user_value1    │      user_value2       │       hkPTR        │   hkPTR_alParent   │      hkSchema      │      hkNSpace      │   hkKVP_TreeKey    │
│ varchar │ varchar │ varchar │ varchar │ varchar │ varchar │ uint32 │ uint32 │ uint32 │ uint32 │ uint32 │ uint32 │ boolean │ boolean │ uint32 │ uint32 │      double       │         double         │      varchar       │      varchar       │      varchar       │      varchar       │      varchar       │
├─────────┼─────────┼─────────┼─────────┼─────────┼─────────┼────────┼────────┼────────┼────────┼────────┼────────┼─────────┼─────────┼────────┼────────┼───────────────────┼────────────────────────┼────────────────────┼────────────────────┼────────────────────┼────────────────────┼────────────────────┤
│ A1      │         │         │         │ A1      │ A1      │      0 │      0 │      7 │      4 │      2 │      7 │ true    │ false   │      1 │     14 │              NULL │     4433021920397551.5 │ 651f_7316ad0e_7937 │ NULL               │ ed9b_0f088177_4778 │ 5651_d3bed103_b56e │ 93db_6dfb96cf_97ac │
│  ╠══➤   │ B       │         │         │ A1      │ B       │      1 │      1 │      4 │      7 │      2 │      3 │ false   │ false   │      2 │      7 │              NULL │      663113530824211.6 │ 7dde_0286883e_99f0 │ 651f_7316ad0e_7937 │ ab05_05d398af_162d │ e726_d2daccb9_c1b7 │ 93db_6dfb96cf_97ac │
│  ║      │  ╠══➤   │ C       │         │ A1      │ C       │      2 │      2 │      3 │      8 │      0 │      1 │ false   │ true    │      3 │      4 │ 9.700000000000001 │ 1.1602477287697392e+16 │ 8a76_3b5d1b40_c3b7 │ 7dde_0286883e_99f0 │ NULL               │ NULL               │ 93db_6dfb96cf_97ac │
│  ║      │  ╚══➤   │ D       │         │ A1      │ D       │      2 │      3 │      4 │      8 │      0 │      1 │ false   │ true    │      5 │      6 │ 9.700000000000001 │     4523479929846451.0 │ 2b2b_12173109_b90b │ 7dde_0286883e_99f0 │ NULL               │ NULL               │ 93db_6dfb96cf_97ac │
│  ╚══➤   │ E       │         │         │ A1      │ E       │      1 │      4 │      7 │      7 │      2 │      3 │ false   │ false   │      8 │     13 │              NULL │     1785059155888482.2 │ 55a9_e6bd3b86_5127 │ 651f_7316ad0e_7937 │ ab05_05d398af_162d │ 1e9d_2a2bafeb_739d │ 93db_6dfb96cf_97ac │
│         │  ╠══➤   │ F       │         │ A1      │ F       │      2 │      5 │      6 │      8 │      0 │      1 │ false   │ true    │      9 │     10 │ 9.700000000000001 │     8610132418777669.0 │ 8a62_52ffff45_cd45 │ 55a9_e6bd3b86_5127 │ NULL               │ NULL               │ 93db_6dfb96cf_97ac │
│         │  ╚══➤   │ G       │         │ A1      │ G       │      2 │      6 │      7 │      8 │      0 │      1 │ false   │ true    │     11 │     12 │ 9.700000000000001 │ 1.7208435515317248e+16 │ fe21_36c6f771_afce │ 55a9_e6bd3b86_5127 │ NULL               │ NULL               │ 93db_6dfb96cf_97ac │
│ A2      │         │         │         │ A2      │ A2      │      0 │      7 │     13 │      4 │      2 │      6 │ true    │ false   │     15 │     26 │              NULL │ 1.3663814735625294e+16 │ 3b11_96df23ac_693b │ NULL               │ ed7d_7344e28e_2564 │ 3751_3ee19bf6_c82f │ 5bd9_e66a3b90_6091 │
│  ╠══➤   │ E       │         │         │ A2      │ E       │      1 │      8 │     12 │      7 │      2 │      4 │ false   │ false   │     16 │     23 │              NULL │     3190232449575444.0 │ 1681_8fe614e9_1ba9 │ 3b11_96df23ac_693b │ 3a9f_08c41e0c_3512 │ 4357_37919383_f83c │ 5bd9_e66a3b90_6091 │
│  ║      │  ╠══➤   │ E       │         │ A2      │ E       │      2 │      9 │     10 │      8 │      0 │      1 │ false   │ true    │     17 │     18 │ 9.700000000000001 │     8595718552375203.0 │ 015a_855a67fa_417c │ 1681_8fe614e9_1ba9 │ NULL               │ NULL               │ 5bd9_e66a3b90_6091 │
│  ║      │  ╚══➤   │ G       │         │ A2      │ G       │      2 │     10 │     12 │      8 │      1 │      2 │ false   │ false   │     19 │     22 │              NULL │     3201171678032007.0 │ 9529_909d4829_a9c4 │ 1681_8fe614e9_1ba9 │ f48c_1429e50e_64b2 │ 2f06_8e20e26b_d429 │ 5bd9_e66a3b90_6091 │
│  ║      │         │  ╚══➤   │ C       │ A2      │ C       │      3 │     11 │     12 │      1 │      0 │      1 │ false   │ true    │     20 │     21 │ 9.600000000000001 │     3635924175750878.0 │ 3f6d_3c97f51f_b4d1 │ 9529_909d4829_a9c4 │ NULL               │ NULL               │ 5bd9_e66a3b90_6091 │
│  ╚══➤   │ B       │         │         │ A2      │ B       │      1 │     12 │     13 │      7 │      0 │      1 │ false   │ true    │     24 │     25 │               9.8 │ 1.2150902473689224e+16 │ 0e55_d081ac87_de75 │ 3b11_96df23ac_693b │ NULL               │ NULL               │ 5bd9_e66a3b90_6091 │
│ Z       │         │         │         │ Z       │ Z       │      0 │     13 │     14 │      4 │      0 │      1 │ true    │ true    │     27 │     28 │               9.9 │  1.063393377393216e+16 │ 4723_f0d8bbed_13d4 │ NULL               │ NULL               │ NULL               │ 4af5_9683f8ba_0eb3 │
│ Y       │         │         │         │ Y       │ Y       │      0 │     14 │     20 │      4 │      3 │      6 │ true    │ false   │     29 │     40 │              NULL │     5500682402888033.0 │ cbe5_38955546_922d │ NULL               │ 43ef_ca1a6efd_1524 │ 4e2d_f1bdb61d_b65f │ ed8f_f8a8ad8a_03ca │
│  ╠══➤   │ V       │         │         │ Y       │ V       │      1 │     15 │     17 │      7 │      1 │      2 │ false   │ false   │     30 │     33 │              NULL │     8615506271043085.0 │ cefc_175ce760_f3b4 │ cbe5_38955546_922d │ f48c_1429e50e_64b2 │ f82e_e5644582_98f2 │ ed8f_f8a8ad8a_03ca │
│  ║      │  ╚══➤   │ V       │         │ Y       │ V       │      2 │     16 │     17 │      8 │      0 │      1 │ false   │ true    │     31 │     32 │ 9.700000000000001 │     1771945185112145.8 │ 5b4e_4b7e3f8d_9d3d │ cefc_175ce760_f3b4 │ NULL               │ NULL               │ ed8f_f8a8ad8a_03ca │
│  ╠══➤   │ W       │         │         │ Y       │ W       │      1 │     17 │     18 │      7 │      0 │      1 │ false   │ true    │     34 │     35 │               9.8 │     9244145388597298.0 │ c443_c5fc6dcd_e3c8 │ cbe5_38955546_922d │ NULL               │ NULL               │ ed8f_f8a8ad8a_03ca │
│  ╚══➤   │ X       │         │         │ Y       │ X       │      1 │     18 │     20 │      7 │      1 │      2 │ false   │ false   │     36 │     39 │              NULL │ 1.3577542752436462e+16 │ 96d0_65fd11bb_7900 │ cbe5_38955546_922d │ f48c_1429e50e_64b2 │ 73d6_b5bcf26b_18db │ ed8f_f8a8ad8a_03ca │
│         │  ╚══➤   │ X       │         │ Y       │ X       │      2 │     19 │     20 │      8 │      0 │      1 │ false   │ true    │     37 │     38 │ 9.700000000000001 │     8454898790149170.0 │ ed70_546fc57c_f6cc │ 96d0_65fd11bb_7900 │ NULL               │ NULL               │ ed8f_f8a8ad8a_03ca │
├─────────┴─────────┴─────────┴─────────┴─────────┴─────────┴────────┴────────┴────────┴────────┴────────┴────────┴─────────┴─────────┴────────┴────────┴───────────────────┴────────────────────────┴────────────────────┴────────────────────┴────────────────────┴────────────────────┴────────────────────┤
│ 20 rows                                                                                                                                                                                                                                                                                          23 columns │
└─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┘
"""

example_flat_one_ptr_column_all_nodes: str = "example_flat_one_ptr_column_all_nodes.parquet"

"""
example_flat_one_ptr_column_all_nodes.parquet (20, 1)
┌──────────────┬─────────────┬─────────┬─────────┬───────────────┬───────┬───────┬───────┬───────┬───────┬───────┬─────────────────┐
│ column_name  │ column_type │   min   │   max   │ approx_unique │  avg  │  std  │  q25  │  q50  │  q75  │ count │ null_percentage │
│   varchar    │   varchar   │ varchar │ varchar │     int64     │ int32 │ int32 │ int32 │ int32 │ int32 │ int64 │  decimal(9,2)   │
├──────────────┼─────────────┼─────────┼─────────┼───────────────┼───────┼───────┼───────┼───────┼───────┼───────┼─────────────────┤
│ path-to-root │ VARCHAR[]   │ [A1]    │ [Z]     │            20 │  NULL │  NULL │  NULL │  NULL │  NULL │    20 │            0.00 │
└──────────────┴─────────────┴─────────┴─────────┴───────────────┴───────┴───────┴───────┴───────┴───────┴───────┴─────────────────┘

┌───────────────┐
│ path-to-root  │
│   varchar[]   │
├───────────────┤
│ [A1]          │
│ [A1, B]       │
│ [A1, B, C]    │
│ [A1, B, D]    │
│ [A1, E]       │
│ [A1, E, F]    │
│ [A1, E, G]    │
│ [A2]          │
│ [A2, E]       │
│ [A2, E, E]    │
│ [A2, E, G]    │
│ [A2, E, G, C] │
│ [A2, B]       │
│ [Z]           │
│ [Y]           │
│ [Y, V]        │
│ [Y, V, V]     │
│ [Y, W]        │
│ [Y, X]        │
│ [Y, X, X]     │
├───────────────┤
│    20 rows    │
└───────────────┘
"""

example_flat_one_ptr_column_leaves_only: str = "example_flat_one_ptr_column_leaves_only.parquet"

"""
example_flat_one_ptr_column_leaves_only.parquet (11, 1)
┌──────────────┬─────────────┬────────────┬─────────┬───────────────┬───────┬───────┬───────┬───────┬───────┬───────┬─────────────────┐
│ column_name  │ column_type │    min     │   max   │ approx_unique │  avg  │  std  │  q25  │  q50  │  q75  │ count │ null_percentage │
│   varchar    │   varchar   │  varchar   │ varchar │     int64     │ int32 │ int32 │ int32 │ int32 │ int32 │ int64 │  decimal(9,2)   │
├──────────────┼─────────────┼────────────┼─────────┼───────────────┼───────┼───────┼───────┼───────┼───────┼───────┼─────────────────┤
│ path-to-root │ VARCHAR[]   │ [A1, B, C] │ [Z]     │            12 │  NULL │  NULL │  NULL │  NULL │  NULL │    11 │            0.00 │
└──────────────┴─────────────┴────────────┴─────────┴───────────────┴───────┴───────┴───────┴───────┴───────┴───────┴─────────────────┘

┌───────────────┐
│ path-to-root  │
│   varchar[]   │
├───────────────┤
│ [A1, B, C]    │
│ [A1, B, D]    │
│ [A1, E, F]    │
│ [A1, E, G]    │
│ [A2, E, E]    │
│ [A2, E, G, C] │
│ [A2, B]       │
│ [Z]           │
│ [Y, V, V]     │
│ [Y, W]        │
│ [Y, X, X]     │
├───────────────┤
│    11 rows    │
└───────────────┘
"""

example_flat_one_ptr_column_problematic: str = "example_flat_one_ptr_column_problematic.parquet"

"""
example_flat_one_ptr_column_problematic.parquet (28, 1)
┌──────────────┬─────────────┬─────────┬─────────┬───────────────┬───────┬───────┬───────┬───────┬───────┬───────┬─────────────────┐
│ column_name  │ column_type │   min   │   max   │ approx_unique │  avg  │  std  │  q25  │  q50  │  q75  │ count │ null_percentage │
│   varchar    │   varchar   │ varchar │ varchar │     int64     │ int32 │ int32 │ int32 │ int32 │ int32 │ int64 │  decimal(9,2)   │
├──────────────┼─────────────┼─────────┼─────────┼───────────────┼───────┼───────┼───────┼───────┼───────┼───────┼─────────────────┤
│ path-to-root │ VARCHAR[]   │ [A1]    │ [Z]     │            20 │  NULL │  NULL │  NULL │  NULL │  NULL │    28 │            0.00 │
└──────────────┴─────────────┴─────────┴─────────┴───────────────┴───────┴───────┴───────┴───────┴───────┴───────┴─────────────────┘

┌───────────────┐
│ path-to-root  │
│   varchar[]   │
├───────────────┤
│ [A1, B, C]    │
│ [A1, E, F]    │
│ [A2, E, E]    │
│ [A2, E, G, C] │
│ [Z]           │
│ [Y, V, V]     │
│ [Y, W]        │
│ [Y, X, X]     │
│ [A1]          │
│ [A1, B]       │
│ [A1, B, D]    │
│ [A1, E]       │
│ [A1, E, G]    │
│ [A2]          │
│ [A2, E]       │
│ [A2, E, G]    │
│ [A2, B]       │
│ [Y]           │
│ [Y, V]        │
│ [Y, X]        │
│ [A1, B]       │
│ [Y, V, V]     │
│ [A2, B]       │
│ [A1, E]       │
│ [A2, E, E]    │
│ [A2, E]       │
│ [A1]          │
│ [A2]          │
├───────────────┤
│    28 rows    │
└───────────────┘
"""

example_alist: str = "example_alist.parquet"

"""
example_alist.parquet (20, 5)
┌──────────────┬─────────────┬────────────────────┬────────────────────────┬───────────────┬────────────────────┬─────────────────────┬────────────────────┬────────────────────┬────────────────────────┬───────┬─────────────────┐
│ column_name  │ column_type │        min         │          max           │ approx_unique │        avg         │         std         │        q25         │        q50         │          q75           │ count │ null_percentage │
│   varchar    │   varchar   │      varchar       │        varchar         │     int64     │      varchar       │       varchar       │      varchar       │      varchar       │        varchar         │ int64 │  decimal(9,2)   │
├──────────────┼─────────────┼────────────────────┼────────────────────────┼───────────────┼────────────────────┼─────────────────────┼────────────────────┼────────────────────┼────────────────────────┼───────┼─────────────────┤
│ parent       │ VARCHAR     │ 1681_8fe614e9_1ba9 │ cefc_175ce760_f3b4     │            10 │ NULL               │ NULL                │ NULL               │ NULL               │ NULL                   │    20 │           20.00 │
│ child        │ VARCHAR     │ 015a_855a67fa_417c │ fe21_36c6f771_afce     │            18 │ NULL               │ NULL                │ NULL               │ NULL               │ NULL                   │    20 │            0.00 │
│ business_key │ VARCHAR     │ A1                 │ Z                      │            15 │ NULL               │ NULL                │ NULL               │ NULL               │ NULL                   │    20 │            0.00 │
│ user_value1  │ DOUBLE      │ 9.600000000000001  │ 9.9                    │             4 │ 9.727272727272728  │ 0.07862453931068929 │ 9.700000000000001  │ 9.700000000000001  │ 9.775                  │    20 │           45.00 │
│ user_value2  │ DOUBLE      │ 663113530824211.6  │ 1.7208435515317248e+16 │            20 │ 7553106919397771.0 │ 4653821326669313.0  │ 3418547926891442.5 │ 8525308671262186.0 │ 1.1118205530814776e+16 │    20 │            0.00 │
└──────────────┴─────────────┴────────────────────┴────────────────────────┴───────────────┴────────────────────┴─────────────────────┴────────────────────┴────────────────────┴────────────────────────┴───────┴─────────────────┘

┌────────────────────┬────────────────────┬──────────────┬───────────────────┬────────────────────────┐
│       parent       │       child        │ business_key │    user_value1    │      user_value2       │
│      varchar       │      varchar       │   varchar    │      double       │         double         │
├────────────────────┼────────────────────┼──────────────┼───────────────────┼────────────────────────┤
│ NULL               │ 651f_7316ad0e_7937 │ A1           │              NULL │     4433021920397551.5 │
│ 651f_7316ad0e_7937 │ 7dde_0286883e_99f0 │ B            │              NULL │      663113530824211.6 │
│ 7dde_0286883e_99f0 │ 8a76_3b5d1b40_c3b7 │ C            │ 9.700000000000001 │ 1.1602477287697392e+16 │
│ 7dde_0286883e_99f0 │ 2b2b_12173109_b90b │ D            │ 9.700000000000001 │     4523479929846451.0 │
│ 651f_7316ad0e_7937 │ 55a9_e6bd3b86_5127 │ E            │              NULL │     1785059155888482.2 │
│ 55a9_e6bd3b86_5127 │ 8a62_52ffff45_cd45 │ F            │ 9.700000000000001 │     8610132418777669.0 │
│ 55a9_e6bd3b86_5127 │ fe21_36c6f771_afce │ G            │ 9.700000000000001 │ 1.7208435515317248e+16 │
│ NULL               │ 3b11_96df23ac_693b │ A2           │              NULL │ 1.3663814735625294e+16 │
│ 3b11_96df23ac_693b │ 1681_8fe614e9_1ba9 │ E            │              NULL │     3190232449575444.0 │
│ 1681_8fe614e9_1ba9 │ 015a_855a67fa_417c │ E            │ 9.700000000000001 │     8595718552375203.0 │
│ 1681_8fe614e9_1ba9 │ 9529_909d4829_a9c4 │ G            │              NULL │     3201171678032007.0 │
│ 9529_909d4829_a9c4 │ 3f6d_3c97f51f_b4d1 │ C            │ 9.600000000000001 │     3635924175750878.0 │
│ 3b11_96df23ac_693b │ 0e55_d081ac87_de75 │ B            │               9.8 │ 1.2150902473689224e+16 │
│ NULL               │ 4723_f0d8bbed_13d4 │ Z            │               9.9 │  1.063393377393216e+16 │
│ NULL               │ cbe5_38955546_922d │ Y            │              NULL │     5500682402888033.0 │
│ cbe5_38955546_922d │ cefc_175ce760_f3b4 │ V            │              NULL │     8615506271043085.0 │
│ cefc_175ce760_f3b4 │ 5b4e_4b7e3f8d_9d3d │ V            │ 9.700000000000001 │     1771945185112145.8 │
│ cbe5_38955546_922d │ c443_c5fc6dcd_e3c8 │ W            │               9.8 │     9244145388597298.0 │
│ cbe5_38955546_922d │ 96d0_65fd11bb_7900 │ X            │              NULL │ 1.3577542752436462e+16 │
│ 96d0_65fd11bb_7900 │ ed70_546fc57c_f6cc │ X            │ 9.700000000000001 │     8454898790149170.0 │
├────────────────────┴────────────────────┴──────────────┴───────────────────┴────────────────────────┤
│ 20 rows                                                                                   5 columns │
└─────────────────────────────────────────────────────────────────────────────────────────────────────┘
"""

example_full_many_permutations: str = "example_full_many_permutations.parquet"

"""
example_full_many_permutations.parquet (480, 21)
┌────────────────┬─────────────┬─────────┬─────────┬───────────────┬─────────┬────────────────────┬─────────┬─────────┬─────────┬───────┬─────────────────┐
│  column_name   │ column_type │   min   │   max   │ approx_unique │   avg   │        std         │   q25   │   q50   │   q75   │ count │ null_percentage │
│    varchar     │   varchar   │ varchar │ varchar │     int64     │ varchar │      varchar       │ varchar │ varchar │ varchar │ int64 │  decimal(9,2)   │
├────────────────┼─────────────┼─────────┼─────────┼───────────────┼─────────┼────────────────────┼─────────┼─────────┼─────────┼───────┼─────────────────┤
│ p000_3         │ VARCHAR     │ A1      │ Z       │             4 │ NULL    │ NULL               │ NULL    │ NULL    │ NULL    │   480 │            0.00 │
│ p001_3         │ VARCHAR     │ B       │ X       │             5 │ NULL    │ NULL               │ NULL    │ NULL    │ NULL    │   480 │           20.00 │
│ p002_3         │ VARCHAR     │ C       │ X       │             7 │ NULL    │ NULL               │ NULL    │ NULL    │ NULL    │   480 │           55.00 │
│ p003_3         │ VARCHAR     │ C       │ C       │             1 │ NULL    │ NULL               │ NULL    │ NULL    │ NULL    │   480 │           95.00 │
│ cHead          │ VARCHAR     │ A1      │ Z       │             4 │ NULL    │ NULL               │ NULL    │ NULL    │ NULL    │   480 │            0.00 │
│ cTail          │ VARCHAR     │ A1      │ Z       │            15 │ NULL    │ NULL               │ NULL    │ NULL    │ NULL    │   480 │            0.00 │
│ cDepth         │ UINTEGER    │ 0       │ 3       │             4 │ 1.3     │ 0.8434940750813169 │ 1       │ 1       │ 2       │   480 │            0.00 │
│ cStart         │ UINTEGER    │ 0       │ 19      │            22 │ 9.5     │ 5.7722972419004694 │ 5       │ 10      │ 14      │   480 │            0.00 │
│ cStop          │ UINTEGER    │ 1       │ 20      │            20 │ 11.8    │ 5.659215699918549  │ 6       │ 12      │ 17      │   480 │            0.00 │
│ cWidth         │ UINTEGER    │ 1       │ 8       │             4 │ 6.5     │ 1.9385120092537154 │ 6       │ 7       │ 8       │   480 │            0.00 │
│ cOut           │ UINTEGER    │ 0       │ 3       │             4 │ 0.8     │ 0.9808181153329828 │ 0       │ 0       │ 2       │   480 │            0.00 │
│ cSize          │ UINTEGER    │ 1       │ 7       │             6 │ 2.3     │ 1.9019822644932223 │ 1       │ 1       │ 3       │   480 │            0.00 │
│ cIsRoot        │ BOOLEAN     │ false   │ true    │             2 │ NULL    │ NULL               │ NULL    │ NULL    │ NULL    │   480 │            0.00 │
│ cIsLeaf        │ BOOLEAN     │ false   │ true    │             2 │ NULL    │ NULL               │ NULL    │ NULL    │ NULL    │   480 │            0.00 │
│ cLeft          │ UINTEGER    │ 1       │ 39      │            39 │ 18.7    │ 11.427250147302228 │ 8       │ 18      │ 29      │   480 │            0.00 │
│ cRight         │ UINTEGER    │ 2       │ 40      │            39 │ 22.3    │ 11.400911951217562 │ 12      │ 23      │ 33      │   480 │            0.00 │
│ v000_3         │ VARCHAR     │         │ Z       │             9 │ NULL    │ NULL               │ NULL    │ NULL    │ NULL    │   480 │            0.00 │
│ v001_3         │ VARCHAR     │         │ X       │             9 │ NULL    │ NULL               │ NULL    │ NULL    │ NULL    │   480 │            0.00 │
│ v002_3         │ VARCHAR     │         │ X       │            10 │ NULL    │ NULL               │ NULL    │ NULL    │ NULL    │   480 │            0.00 │
│ v003_3         │ VARCHAR     │         │ C       │             2 │ NULL    │ NULL               │ NULL    │ NULL    │ NULL    │   480 │            0.00 │
│ PERMUTATION_ID │ INTEGER     │ 0       │ 23      │            24 │ 11.5    │ 6.929408449599277  │ 6       │ 12      │ 18      │   480 │            0.00 │
├────────────────┴─────────────┴─────────┴─────────┴───────────────┴─────────┴────────────────────┴─────────┴─────────┴─────────┴───────┴─────────────────┤
│ 21 rows                                                                                                                                      12 columns │
└─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┘

┌─────────┬─────────┬─────────┬─────────┬─────────┬─────────┬────────┬────────┬────────┬────────┬────────┬────────┬─────────┬─────────┬────────┬────────┬─────────┬─────────┬─────────┬─────────┬────────────────┐
│ p000_3  │ p001_3  │ p002_3  │ p003_3  │  cHead  │  cTail  │ cDepth │ cStart │ cStop  │ cWidth │  cOut  │ cSize  │ cIsRoot │ cIsLeaf │ cLeft  │ cRight │ v000_3  │ v001_3  │ v002_3  │ v003_3  │ PERMUTATION_ID │
│ varchar │ varchar │ varchar │ varchar │ varchar │ varchar │ uint32 │ uint32 │ uint32 │ uint32 │ uint32 │ uint32 │ boolean │ boolean │ uint32 │ uint32 │ varchar │ varchar │ varchar │ varchar │     int32      │
├─────────┼─────────┼─────────┼─────────┼─────────┼─────────┼────────┼────────┼────────┼────────┼────────┼────────┼─────────┼─────────┼────────┼────────┼─────────┼─────────┼─────────┼─────────┼────────────────┤
│ Z       │ NULL    │ NULL    │ NULL    │ Z       │ Z       │      0 │      0 │      1 │      4 │      0 │      1 │ true    │ true    │      1 │      2 │ Z       │         │         │         │              0 │
│ A1      │ NULL    │ NULL    │ NULL    │ A1      │ A1      │      0 │      1 │      8 │      4 │      2 │      7 │ true    │ false   │      3 │     16 │ A1      │         │         │         │              0 │
│ A1      │ B       │ NULL    │ NULL    │ A1      │ B       │      1 │      2 │      5 │      7 │      2 │      3 │ false   │ false   │      4 │      9 │  ╠══➤   │ B       │         │         │              0 │
│ A1      │ B       │ C       │ NULL    │ A1      │ C       │      2 │      3 │      4 │      8 │      0 │      1 │ false   │ true    │      5 │      6 │  ║      │  ╠══➤   │ C       │         │              0 │
│ A1      │ B       │ D       │ NULL    │ A1      │ D       │      2 │      4 │      5 │      8 │      0 │      1 │ false   │ true    │      7 │      8 │  ║      │  ╚══➤   │ D       │         │              0 │
│ ·       │ ·       │ ·       │  ·      │ ·       │ ·       │      · │      · │      · │      · │      · │      · │   ·     │  ·      │      · │      · │   ·     │   ·     │ ·       │ ·       │              · │
│ ·       │ ·       │ ·       │  ·      │ ·       │ ·       │      · │      · │      · │      · │      · │      · │   ·     │  ·      │      · │      · │   ·     │   ·     │ ·       │ ·       │              · │
│ ·       │ ·       │ ·       │  ·      │ ·       │ ·       │      · │      · │      · │      · │      · │      · │   ·     │  ·      │      · │      · │   ·     │   ·     │ ·       │ ·       │              · │
│ A1      │ B       │ D       │ NULL    │ A1      │ D       │      2 │     15 │     16 │      8 │      0 │      1 │ false   │ true    │     29 │     30 │  ║      │  ╚══➤   │ D       │         │             23 │
│ A1      │ E       │ NULL    │ NULL    │ A1      │ E       │      1 │     16 │     19 │      7 │      2 │      3 │ false   │ false   │     32 │     37 │  ╚══➤   │ E       │         │         │             23 │
│ A1      │ E       │ F       │ NULL    │ A1      │ F       │      2 │     17 │     18 │      8 │      0 │      1 │ false   │ true    │     33 │     34 │         │  ╠══➤   │ F       │         │             23 │
│ A1      │ E       │ G       │ NULL    │ A1      │ G       │      2 │     18 │     19 │      8 │      0 │      1 │ false   │ true    │     35 │     36 │         │  ╚══➤   │ G       │         │             23 │
│ Z       │ NULL    │ NULL    │ NULL    │ Z       │ Z       │      0 │     19 │     20 │      4 │      0 │      1 │ true    │ true    │     39 │     40 │ Z       │         │         │         │             23 │
├─────────┴─────────┴─────────┴─────────┴─────────┴─────────┴────────┴────────┴────────┴────────┴────────┴────────┴─────────┴─────────┴────────┴────────┴─────────┴─────────┴─────────┴─────────┴────────────────┤
│ 480 rows (10 shown)                                                                                                                                                                                 21 columns │
└────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┘
"""

unit_test_aa_mvp: str = "unit_test_aa_mvp.parquet"

"""
unit_test_aa_mvp.parquet (52529, 2)
┌─────────────┬─────────────┬─────────┬─────────┬───────────────┬───────────────────┬────────────────────┬─────────┬─────────┬─────────┬───────┬─────────────────┐
│ column_name │ column_type │   min   │   max   │ approx_unique │        avg        │        std         │   q25   │   q50   │   q75   │ count │ null_percentage │
│   varchar   │   varchar   │ varchar │ varchar │     int64     │      varchar      │      varchar       │ varchar │ varchar │ varchar │ int64 │  decimal(9,2)   │
├─────────────┼─────────────┼─────────┼─────────┼───────────────┼───────────────────┼────────────────────┼─────────┼─────────┼─────────┼───────┼─────────────────┤
│ cTail       │ VARCHAR     │ aC      │ zX      │           225 │ NULL              │ NULL               │ NULL    │ NULL    │ NULL    │  9999 │            0.00 │
│ cDepth      │ UINTEGER    │ 0       │ 9       │            11 │ 7.587058705870587 │ 0.9651853999233575 │ 7       │ 8       │ 8       │  9999 │            0.00 │
└─────────────┴─────────────┴─────────┴─────────┴───────────────┴───────────────────┴────────────────────┴─────────┴─────────┴─────────┴───────┴─────────────────┘

┌─────────┬────────┐
│  cTail  │ cDepth │
│ varchar │ uint32 │
├─────────┼────────┤
│ bP      │      0 │
│ mJ      │      1 │
│ sN      │      2 │
│ cP      │      3 │
│ xQ      │      4 │
│ ·       │      · │
│ ·       │      · │
│ ·       │      · │
│ xX      │      9 │
│ xD      │      6 │
│ tH      │      7 │
│ pK      │      8 │
│ xY      │      9 │
├─────────┴────────┤
│    9999 rows     │
│    (10 shown)    │
└──────────────────┘

┌─────────┬─────────┬─────────┬─────────┬─────────┬─────────┬─────────┬─────────┬─────────┬─────────┬─────────┬─────────┬────────┬────────┬────────┬────────┬────────┬────────┬─────────┬─────────┬────────┬────────┬────────────────────┬────────────────────┬────────────────────┬────────────────────┬────────────────────┐
│ v000_9  │ v001_9  │ v002_9  │ v003_9  │ v004_9  │ v005_9  │ v006_9  │ v007_9  │ v008_9  │ v009_9  │  cHead  │  cTail  │ cDepth │ cStart │ cStop  │ cWidth │  cOut  │ cSize  │ cIsRoot │ cIsLeaf │ cLeft  │ cRight │       hkPTR        │   hkPTR_alParent   │      hkSchema      │      hkNSpace      │   hkKVP_TreeKey    │
│ varchar │ varchar │ varchar │ varchar │ varchar │ varchar │ varchar │ varchar │ varchar │ varchar │ varchar │ varchar │ uint32 │ uint32 │ uint32 │ uint32 │ uint32 │ uint32 │ boolean │ boolean │ uint32 │ uint32 │      varchar       │      varchar       │      varchar       │      varchar       │      varchar       │
├─────────┼─────────┼─────────┼─────────┼─────────┼─────────┼─────────┼─────────┼─────────┼─────────┼─────────┼─────────┼────────┼────────┼────────┼────────┼────────┼────────┼─────────┼─────────┼────────┼────────┼────────────────────┼────────────────────┼────────────────────┼────────────────────┼────────────────────┤
│ bP      │         │         │         │         │         │         │         │         │         │ bP      │ bP      │      0 │      0 │   9999 │      1 │      2 │   9999 │ true    │ false   │      1 │  19998 │ 669b_46e2ccc8_e8e7 │ NULL               │ 7d1a_547eb705_14ae │ fc49_5a544934_a1ca │ 6946_a4754ec8_25ef │
│  ╠══➤   │ mJ      │         │         │         │         │         │         │         │         │ bP      │ mJ      │      1 │      1 │   3585 │      2 │      2 │   3584 │ false   │ false   │      2 │   7169 │ f054_8ec03560_ebe0 │ 669b_46e2ccc8_e8e7 │ 9b53_a9506e6b_31d2 │ 3704_4c766ef3_bc18 │ 6946_a4754ec8_25ef │
│  ║      │  ╠══➤   │ sN      │         │         │         │         │         │         │         │ bP      │ sN      │      2 │      2 │   1821 │      4 │      2 │   1819 │ false   │ false   │      3 │   3640 │ 4d42_b34a8c6c_9c11 │ f054_8ec03560_ebe0 │ 11c8_e0116a84_e71e │ 0c11_434582e6_3727 │ 6946_a4754ec8_25ef │
│  ║      │  ║      │  ╠══➤   │ cP      │         │         │         │         │         │         │ bP      │ cP      │      3 │      3 │    803 │      7 │      1 │    800 │ false   │ false   │      4 │   1603 │ 7853_2ace46da_2a08 │ 4d42_b34a8c6c_9c11 │ 1b50_f0a06a8b_3640 │ 9db0_cccc07d4_3e79 │ 6946_a4754ec8_25ef │
│  ║      │  ║      │  ║      │  ╚══➤   │ xQ      │         │         │         │         │         │ bP      │ xQ      │      4 │      4 │    803 │      8 │      1 │    799 │ false   │ false   │      5 │   1602 │ e2de_cf8f36b2_1b0f │ 7853_2ace46da_2a08 │ 15ff_79932e49_0257 │ 9db0_cccc07d4_3e79 │ 6946_a4754ec8_25ef │
│ ·       │ ·       │ ·       │ ·       │ ·       │ ·       │ ·       │ ·       │ ·       │ ·       │ ·       │ ·       │      · │      · │     ·  │      · │      · │      · │   ·     │  ·      │      · │     ·  │         ·          │         ·          │  ·                 │  ·                 │         ·          │
│ ·       │ ·       │ ·       │ ·       │ ·       │ ·       │ ·       │ ·       │ ·       │ ·       │ ·       │ ·       │      · │      · │     ·  │      · │      · │      · │   ·     │  ·      │      · │     ·  │         ·          │         ·          │  ·                 │  ·                 │         ·          │
│ ·       │ ·       │ ·       │ ·       │ ·       │ ·       │ ·       │ ·       │ ·       │ ·       │ ·       │ ·       │      · │      · │     ·  │      · │      · │      · │   ·     │  ·      │      · │     ·  │         ·          │         ·          │  ·                 │  ·                 │         ·          │
│         │         │         │         │         │  ║      │         │         │  ╚══➤   │ xX      │ bP      │ xX      │      9 │   9994 │   9995 │   1976 │      0 │      1 │ false   │ true    │  19980 │  19981 │ eeaa_ac1941e3_ff4d │ fc44_26c10985_61f2 │ NULL               │ NULL               │ 6946_a4754ec8_25ef │
│         │         │         │         │         │  ╚══➤   │ xD      │         │         │         │ bP      │ xD      │      6 │   9995 │   9999 │   1191 │      1 │      4 │ false   │ false   │  19985 │  19992 │ 0e4d_ca66aa31_63c9 │ 0954_10ed3d1d_6282 │ ca78_fa03a089_7d7b │ 28af_12aa9a30_fcbc │ 6946_a4754ec8_25ef │
│         │         │         │         │         │         │  ╚══➤   │ tH      │         │         │ bP      │ tH      │      7 │   9996 │   9999 │   3580 │      1 │      3 │ false   │ false   │  19986 │  19991 │ ec23_b7dfe54b_2103 │ 0e4d_ca66aa31_63c9 │ 2636_f95583a1_cb0e │ abcb_199c3412_42b5 │ 6946_a4754ec8_25ef │
│         │         │         │         │         │         │         │  ╚══➤   │ pK      │         │ bP      │ pK      │      8 │   9997 │   9999 │   3220 │      1 │      2 │ false   │ false   │  19987 │  19990 │ cf44_9c329711_aa28 │ ec23_b7dfe54b_2103 │ f48c_1429e50e_64b2 │ d3a1_d3170540_02c8 │ 6946_a4754ec8_25ef │
│         │         │         │         │         │         │         │         │  ╚══➤   │ xY      │ bP      │ xY      │      9 │   9998 │   9999 │   1976 │      0 │      1 │ false   │ true    │  19988 │  19989 │ a89d_42915822_2974 │ cf44_9c329711_aa28 │ NULL               │ NULL               │ 6946_a4754ec8_25ef │
├─────────┴─────────┴─────────┴─────────┴─────────┴─────────┴─────────┴─────────┴─────────┴─────────┴─────────┴─────────┴────────┴────────┴────────┴────────┴────────┴────────┴─────────┴─────────┴────────┴────────┴────────────────────┴────────────────────┴────────────────────┴────────────────────┴────────────────────┤
│ 9999 rows (10 shown)                                                                                                                                                                                                                                                                                            27 columns │
└────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┘
"""

unit_test_bb_mvp: str = "unit_test_bb_mvp.parquet"

"""
unit_test_bb_mvp.parquet (52419, 2)
┌─────────────┬─────────────┬─────────┬─────────┬───────────────┬──────────────────┬────────────────────┬─────────┬─────────┬─────────┬───────┬─────────────────┐
│ column_name │ column_type │   min   │   max   │ approx_unique │       avg        │        std         │   q25   │   q50   │   q75   │ count │ null_percentage │
│   varchar   │   varchar   │ varchar │ varchar │     int64     │     varchar      │      varchar       │ varchar │ varchar │ varchar │ int64 │  decimal(9,2)   │
├─────────────┼─────────────┼─────────┼─────────┼───────────────┼──────────────────┼────────────────────┼─────────┼─────────┼─────────┼───────┼─────────────────┤
│ cTail       │ VARCHAR     │ aC      │ zX      │           225 │ NULL             │ NULL               │ NULL    │ NULL    │ NULL    │  9999 │            0.00 │
│ cDepth      │ UINTEGER    │ 0       │ 9       │            11 │ 7.58955895589559 │ 0.9640232692587264 │ 7       │ 8       │ 8       │  9999 │            0.00 │
└─────────────┴─────────────┴─────────┴─────────┴───────────────┴──────────────────┴────────────────────┴─────────┴─────────┴─────────┴───────┴─────────────────┘

┌─────────┬────────┐
│  cTail  │ cDepth │
│ varchar │ uint32 │
├─────────┼────────┤
│ eR      │      0 │
│ yA      │      1 │
│ uB      │      2 │
│ wX      │      3 │
│ fG      │      4 │
│ ·       │      · │
│ ·       │      · │
│ ·       │      · │
│ wO      │      7 │
│ kK      │      8 │
│ lB      │      9 │
│ qO      │      8 │
│ kH      │      9 │
├─────────┴────────┤
│    9999 rows     │
│    (10 shown)    │
└──────────────────┘

┌─────────┬─────────┬─────────┬─────────┬─────────┬─────────┬─────────┬─────────┬─────────┬─────────┬─────────┬─────────┬────────┬────────┬────────┬────────┬────────┬────────┬─────────┬─────────┬────────┬────────┬────────────────────┬────────────────────┬────────────────────┬────────────────────┬────────────────────┐
│ v000_9  │ v001_9  │ v002_9  │ v003_9  │ v004_9  │ v005_9  │ v006_9  │ v007_9  │ v008_9  │ v009_9  │  cHead  │  cTail  │ cDepth │ cStart │ cStop  │ cWidth │  cOut  │ cSize  │ cIsRoot │ cIsLeaf │ cLeft  │ cRight │       hkPTR        │   hkPTR_alParent   │      hkSchema      │      hkNSpace      │   hkKVP_TreeKey    │
│ varchar │ varchar │ varchar │ varchar │ varchar │ varchar │ varchar │ varchar │ varchar │ varchar │ varchar │ varchar │ uint32 │ uint32 │ uint32 │ uint32 │ uint32 │ uint32 │ boolean │ boolean │ uint32 │ uint32 │      varchar       │      varchar       │      varchar       │      varchar       │      varchar       │
├─────────┼─────────┼─────────┼─────────┼─────────┼─────────┼─────────┼─────────┼─────────┼─────────┼─────────┼─────────┼────────┼────────┼────────┼────────┼────────┼────────┼─────────┼─────────┼────────┼────────┼────────────────────┼────────────────────┼────────────────────┼────────────────────┼────────────────────┤
│ eR      │         │         │         │         │         │         │         │         │         │ eR      │ eR      │      0 │      0 │   9999 │      1 │      2 │   9999 │ true    │ false   │      1 │  19998 │ 93c3_5668d05c_5f0d │ NULL               │ a440_9dd025e8_97c8 │ fc49_5a544934_a1ca │ 9bf3_5af2543b_82d9 │
│  ╠══➤   │ yA      │         │         │         │         │         │         │         │         │ eR      │ yA      │      1 │      1 │   3776 │      2 │      2 │   3775 │ false   │ false   │      2 │   7551 │ 9931_f0d71960_14dd │ 93c3_5668d05c_5f0d │ 010e_0d79f2e9_2770 │ ba5f_33c6c715_58ec │ 9bf3_5af2543b_82d9 │
│  ║      │  ╠══➤   │ uB      │         │         │         │         │         │         │         │ eR      │ uB      │      2 │      2 │   1819 │      4 │      2 │   1817 │ false   │ false   │      3 │   3636 │ 6117_3d614dfc_7686 │ 9931_f0d71960_14dd │ 321b_0284af71_6b38 │ 0575_bf811c75_af62 │ 9bf3_5af2543b_82d9 │
│  ║      │  ║      │  ╠══➤   │ wX      │         │         │         │         │         │         │ eR      │ wX      │      3 │      3 │    850 │      7 │      1 │    847 │ false   │ false   │      4 │   1697 │ 6a11_637a27a7_284c │ 6117_3d614dfc_7686 │ d979_d9f86989_1810 │ 67f6_ef26e456_97d6 │ 9bf3_5af2543b_82d9 │
│  ║      │  ║      │  ║      │  ╚══➤   │ fG      │         │         │         │         │         │ eR      │ fG      │      4 │      4 │    850 │      8 │      2 │    846 │ false   │ false   │      5 │   1696 │ 0f82_4e154f61_357d │ 6a11_637a27a7_284c │ cb25_74dbd488_1c3c │ 67f6_ef26e456_97d6 │ 9bf3_5af2543b_82d9 │
│ ·       │ ·       │ ·       │ ·       │ ·       │ ·       │ ·       │ ·       │ ·       │ ·       │ ·       │ ·       │      · │      · │     ·  │      · │      · │      · │   ·     │   ·     │      · │     ·  │         ·          │         ·          │         ·          │         ·          │         ·          │
│ ·       │ ·       │ ·       │ ·       │ ·       │ ·       │ ·       │ ·       │ ·       │ ·       │ ·       │ ·       │      · │      · │     ·  │      · │      · │      · │   ·     │   ·     │      · │     ·  │         ·          │         ·          │         ·          │         ·          │         ·          │
│ ·       │ ·       │ ·       │ ·       │ ·       │ ·       │ ·       │ ·       │ ·       │ ·       │ ·       │ ·       │      · │      · │     ·  │      · │      · │      · │   ·     │   ·     │      · │     ·  │         ·          │         ·          │         ·          │         ·          │         ·          │
│         │         │         │         │         │         │  ╚══➤   │ wO      │         │         │ eR      │ wO      │      7 │   9994 │   9999 │   3585 │      2 │      5 │ false   │ false   │  19982 │  19991 │ 1a56_22a34dd4_8abf │ cca0_ec9e7767_009d │ cba2_b0e5c60b_905c │ 41c8_bed54a8a_eddd │ 9bf3_5af2543b_82d9 │
│         │         │         │         │         │         │         │  ╠══➤   │ kK      │         │ eR      │ kK      │      8 │   9995 │   9997 │   3224 │      1 │      2 │ false   │ false   │  19983 │  19986 │ 3832_a4886cee_79cb │ 1a56_22a34dd4_8abf │ f48c_1429e50e_64b2 │ 1ef4_607e9c0e_a0d0 │ 9bf3_5af2543b_82d9 │
│         │         │         │         │         │         │         │  ║      │  ╚══➤   │ lB      │ eR      │ lB      │      9 │   9996 │   9997 │   1980 │      0 │      1 │ false   │ true    │  19984 │  19985 │ a0c3_2715e837_f372 │ 3832_a4886cee_79cb │ NULL               │ NULL               │ 9bf3_5af2543b_82d9 │
│         │         │         │         │         │         │         │  ╚══➤   │ qO      │         │ eR      │ qO      │      8 │   9997 │   9999 │   3224 │      1 │      2 │ false   │ false   │  19987 │  19990 │ 60e4_5541770f_1f24 │ 1a56_22a34dd4_8abf │ f48c_1429e50e_64b2 │ 3391_826c0214_3bd2 │ 9bf3_5af2543b_82d9 │
│         │         │         │         │         │         │         │         │  ╚══➤   │ kH      │ eR      │ kH      │      9 │   9998 │   9999 │   1980 │      0 │      1 │ false   │ true    │  19988 │  19989 │ f229_65b57dfa_2661 │ 60e4_5541770f_1f24 │ NULL               │ NULL               │ 9bf3_5af2543b_82d9 │
├─────────┴─────────┴─────────┴─────────┴─────────┴─────────┴─────────┴─────────┴─────────┴─────────┴─────────┴─────────┴────────┴────────┴────────┴────────┴────────┴────────┴─────────┴─────────┴────────┴────────┴────────────────────┴────────────────────┴────────────────────┴────────────────────┴────────────────────┤
│ 9999 rows (10 shown)                                                                                                                                                                                                                                                                                            27 columns │
└────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┘
"""

unit_test_cc_mvp: str = "unit_test_cc_mvp.parquet"

"""
unit_test_cc_mvp.parquet (49246, 2)
┌─────────────┬────────────────────────────────────┬────────────────────────┬─────────────────────────┬───────────────┬────────────────────┬────────────────────┬─────────┬─────────┬─────────┬───────┬─────────────────┐
│ column_name │            column_type             │          min           │           max           │ approx_unique │        avg         │        std         │   q25   │   q50   │   q75   │ count │ null_percentage │
│   varchar   │              varchar               │        varchar         │         varchar         │     int64     │      varchar       │      varchar       │ varchar │ varchar │ varchar │ int64 │  decimal(9,2)   │
├─────────────┼────────────────────────────────────┼────────────────────────┼─────────────────────────┼───────────────┼────────────────────┼────────────────────┼─────────┼─────────┼─────────┼───────┼─────────────────┤
│ cTail       │ STRUCT("type" BIGINT, obj VARCHAR) │ {'type': 0, 'obj': aM} │ {'type': 99, 'obj': zR} │           232 │ NULL               │ NULL               │ NULL    │ NULL    │ NULL    │  9999 │            0.00 │
│ cDepth      │ UINTEGER                           │ 0                      │ 9                       │            11 │ 7.6097609760976095 │ 0.9622442079100391 │ 7       │ 8       │ 8       │  9999 │            0.00 │
└─────────────┴────────────────────────────────────┴────────────────────────┴─────────────────────────┴───────────────┴────────────────────┴────────────────────┴─────────┴─────────┴─────────┴───────┴─────────────────┘

┌────────────────────────────────────┬────────┐
│               cTail                │ cDepth │
│ struct("type" bigint, obj varchar) │ uint32 │
├────────────────────────────────────┼────────┤
│ {'type': 99, 'obj': iO}            │      0 │
│ {'type': 99, 'obj': tB}            │      1 │
│ {'type': 0, 'obj': iE}             │      2 │
│ {'type': 0, 'obj': kH}             │      3 │
│ {'type': 1, 'obj': gD}             │      4 │
│           ·                        │      · │
│           ·                        │      · │
│           ·                        │      · │
│ {'type': 99, 'obj': kX}            │      8 │
│ {'type': 1, 'obj': pV}             │      9 │
│ {'type': 99, 'obj': yN}            │      6 │
│ {'type': 1, 'obj': xD}             │      7 │
│ {'type': 0, 'obj': jZ}             │      8 │
├────────────────────────────────────┴────────┤
│ 9999 rows (10 shown)              2 columns │
└─────────────────────────────────────────────┘

┌───────────┬───────────┬──────────┬──────────┬──────────┬─────────┬───────────┬──────────┬───────────┬──────────┬────────────────────────────────────┬────────────────────────────────────┬────────┬────────┬────────┬────────┬────────┬────────┬─────────┬─────────┬────────┬────────┬────────────────────┬────────────────────┬────────────────────┬────────────────────┬────────────────────┐
│  v000_9   │  v001_9   │  v002_9  │  v003_9  │  v004_9  │ v005_9  │  v006_9   │  v007_9  │  v008_9   │  v009_9  │               cHead                │               cTail                │ cDepth │ cStart │ cStop  │ cWidth │  cOut  │ cSize  │ cIsRoot │ cIsLeaf │ cLeft  │ cRight │       hkPTR        │   hkPTR_alParent   │      hkSchema      │      hkNSpace      │   hkKVP_TreeKey    │
│  varchar  │  varchar  │ varchar  │ varchar  │ varchar  │ varchar │  varchar  │ varchar  │  varchar  │ varchar  │ struct("type" bigint, obj varchar) │ struct("type" bigint, obj varchar) │ uint32 │ uint32 │ uint32 │ uint32 │ uint32 │ uint32 │ boolean │ boolean │ uint32 │ uint32 │      varchar       │      varchar       │      varchar       │      varchar       │      varchar       │
├───────────┼───────────┼──────────┼──────────┼──────────┼─────────┼───────────┼──────────┼───────────┼──────────┼────────────────────────────────────┼────────────────────────────────────┼────────┼────────┼────────┼────────┼────────┼────────┼─────────┼─────────┼────────┼────────┼────────────────────┼────────────────────┼────────────────────┼────────────────────┼────────────────────┤
│ {99,"iO"} │           │          │          │          │         │           │          │           │          │ {'type': 99, 'obj': iO}            │ {'type': 99, 'obj': iO}            │      0 │      0 │   9999 │      1 │      2 │   9999 │ true    │ false   │      1 │  19998 │ 3263_d555d97f_84a2 │ NULL               │ ce11_54594a55_5d8e │ cf88_80f122fb_b8d9 │ 614a_6e13c6b5_b5a8 │
│  ╠══➤     │ {99,"tB"} │          │          │          │         │           │          │           │          │ {'type': 99, 'obj': iO}            │ {'type': 99, 'obj': tB}            │      1 │      1 │   3435 │      2 │      2 │   3434 │ false   │ false   │      2 │   6869 │ fb8f_c21d2863_e9d9 │ 3263_d555d97f_84a2 │ 4ac2_4da3949e_4bfb │ 52f6_15a75859_524d │ 614a_6e13c6b5_b5a8 │
│  ║        │  ╠══➤     │ {0,"iE"} │          │          │         │           │          │           │          │ {'type': 99, 'obj': iO}            │ {'type': 0, 'obj': iE}             │      2 │      2 │   1763 │      4 │      2 │   1761 │ false   │ false   │      3 │   3524 │ 26f1_c8ae9b42_648f │ fb8f_c21d2863_e9d9 │ e7ed_9ae3b7a7_9bed │ 5ab8_e29392af_83ea │ 614a_6e13c6b5_b5a8 │
│  ║        │  ║        │  ╠══➤    │ {0,"kH"} │          │         │           │          │           │          │ {'type': 99, 'obj': iO}            │ {'type': 0, 'obj': kH}             │      3 │      3 │    949 │      6 │      1 │    946 │ false   │ false   │      4 │   1895 │ e034_09fe3447_345f │ 26f1_c8ae9b42_648f │ 5026_9345773f_229a │ 404c_93960513_9f24 │ 614a_6e13c6b5_b5a8 │
│  ║        │  ║        │  ║       │  ╚══➤    │ {1,"gD"} │         │           │          │           │          │ {'type': 99, 'obj': iO}            │ {'type': 1, 'obj': gD}             │      4 │      4 │    949 │      6 │      1 │    945 │ false   │ false   │      5 │   1894 │ f444_6c494705_a1ac │ e034_09fe3447_345f │ 3729_4d66d450_b682 │ 0395_f83c6d9b_77df │ 614a_6e13c6b5_b5a8 │
│ ·         │ ·         │ ·        │ ·        │ ·        │ ·       │ ·         │ ·        │ ·         │ ·        │            ·                       │           ·                        │      · │      · │     ·  │      · │      · │      · │   ·     │   ·     │      · │     ·  │         ·          │         ·          │         ·          │         ·          │         ·          │
│ ·         │ ·         │ ·        │ ·        │ ·        │ ·       │ ·         │ ·        │ ·         │ ·        │            ·                       │           ·                        │      · │      · │     ·  │      · │      · │      · │   ·     │   ·     │      · │     ·  │         ·          │         ·          │         ·          │         ·          │         ·          │
│ ·         │ ·         │ ·        │ ·        │ ·        │ ·       │ ·         │ ·        │ ·         │ ·        │            ·                       │           ·                        │      · │      · │     ·  │      · │      · │      · │   ·     │   ·     │      · │     ·  │         ·          │         ·          │         ·          │         ·          │         ·          │
│           │           │          │          │          │  ║      │           │  ╚══➤    │ {99,"kX"} │          │ {'type': 99, 'obj': iO}            │ {'type': 99, 'obj': kX}            │      8 │   9994 │   9996 │   3215 │      1 │      2 │ false   │ false   │  19981 │  19984 │ 69be_4deeb268_0ecf │ e234_9f93bd94_4963 │ f48c_1429e50e_64b2 │ 37a5_636629cf_8e93 │ 614a_6e13c6b5_b5a8 │
│           │           │          │          │          │  ║      │           │          │  ╚══➤     │ {1,"pV"} │ {'type': 99, 'obj': iO}            │ {'type': 1, 'obj': pV}             │      9 │   9995 │   9996 │   2056 │      0 │      1 │ false   │ true    │  19982 │  19983 │ 52cc_19c4d2df_e40b │ 69be_4deeb268_0ecf │ NULL               │ NULL               │ 614a_6e13c6b5_b5a8 │
│           │           │          │          │          │  ╚══➤   │ {99,"yN"} │          │           │          │ {'type': 99, 'obj': iO}            │ {'type': 99, 'obj': yN}            │      6 │   9996 │   9999 │   1133 │      1 │      3 │ false   │ false   │  19987 │  19992 │ 5176_4c48114f_7062 │ 4947_fba82e1f_a932 │ 2636_f95583a1_cb0e │ af32_755a85ee_e755 │ 614a_6e13c6b5_b5a8 │
│           │           │          │          │          │         │  ╚══➤     │ {1,"xD"} │           │          │ {'type': 99, 'obj': iO}            │ {'type': 1, 'obj': xD}             │      7 │   9997 │   9999 │   3568 │      1 │      2 │ false   │ false   │  19988 │  19991 │ d8fd_7ff74ad7_141e │ 5176_4c48114f_7062 │ f48c_1429e50e_64b2 │ 5753_6b154bb0_dde4 │ 614a_6e13c6b5_b5a8 │
│           │           │          │          │          │         │           │  ╚══➤    │ {0,"jZ"}  │          │ {'type': 99, 'obj': iO}            │ {'type': 0, 'obj': jZ}             │      8 │   9998 │   9999 │   3215 │      0 │      1 │ false   │ true    │  19989 │  19990 │ e60e_a93ec706_44d2 │ d8fd_7ff74ad7_141e │ NULL               │ NULL               │ 614a_6e13c6b5_b5a8 │
├───────────┴───────────┴──────────┴──────────┴──────────┴─────────┴───────────┴──────────┴───────────┴──────────┴────────────────────────────────────┴────────────────────────────────────┴────────┴────────┴────────┴────────┴────────┴────────┴─────────┴─────────┴────────┴────────┴────────────────────┴────────────────────┴────────────────────┴────────────────────┴────────────────────┤
│ 9999 rows (10 shown)                                                                                                                                                                                                                                                                                                                                                               27 columns │
└───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┘
"""

if __name__ == "__main__":
    # run unit tests

    from json import loads
    from itertools import chain, combinations, pairwise

    import polars as pl
    import polars.selectors as cs
    from polars.testing import assert_frame_equal
    import duckdb as db

    from treeSlice import (
        expand_model, refine_model, from_mALPC, from_mList, test_equal,
        cs_ptr, chead, ctail, cdepth, cstart, cstop, cparent, cchild, cbkey, cptr
    )

    _tested_dtypes = (
        cs.string(include_categorical=True) |
        cs.numeric() |
        cs.by_dtype(pl.Enum) |
        cs.by_dtype(pl.Struct({"type": pl.Int64, "obj": pl.String})) |
        cs.by_dtype(pl.Array(inner=pl.String, shape=2))
    )

    df_list_of_Nx_int = pl.DataFrame({"list[i64]": [
        [9, 8, 4, 4], [9, 7], [9, 1, 5, 4], [9, 8, 3, 4], [9, 1, 5, 4], [1], [9, 7, 0, 0],
        [9, 1, 5, 5, 2], [9, 1, 5, 5, 5], [9, 1, 5, 5, 7], [9, 1, 5, 5, 9], [9, 1, 8]
    ]})
    df_list_of_Nx_str = pl.DataFrame({"list[str]": [
        ["9", "8", "4", "4"], ["9", "7"], ["9", "1", "5", "4"], ["9", "8", "3", "4"], ["9", "1", "5", "4"], ["1"], ["9", "7", "0", "0"],
        ["9", "1", "5", "5", "2"], ["9", "1", "5", "5", "5"], ["9", "1", "5", "5", "7"], ["9", "1", "5", "5", "9"], ["9", "1", "8"]
    ]})
    df_list_of_Nx_float = pl.DataFrame({"list[f64]": [
        [9.3, 8.3, 4.3, 4.3], [9.3, 7.3], [9.3, 1.3, 5.3, 4.3], [9.3, 8.3, 3.3, 4.3], [9.3, 1.3, 5.3, 4.3], [1.3], [9.3, 7.3, 0.3, 0.3],
        [9.3, 1.3, 5.3, 5.3, 2.3], [9.3, 1.3, 5.3, 5.3, 5.3], [9.3, 1.3, 5.3, 5.3, 7.3], [9.3, 1.3, 5.3, 5.3, 9.3], [9.3, 1.3, 8.3]
    ]})
    df_array_of_4xFixed_int = pl.DataFrame({"qqq": [
        [9, 8, 4, 4], [9, 1, 5, 4], [9, 8, 3, 4], [9, 1, 5, 4], [9, 7, 0, 0],
        [9, 1, 5, 5], [9, 1, 5, 5], [9, 1, 5, 5], [9, 1, 5, 5], [9, 1, 8, 0]
    ]}).select(pl.col("qqq").list.to_array(width=4).alias("array[i64, 4]"))
    df_JSON_array_of_4xFixed_int = pl.DataFrame({"str": [
        '[9, 8, 4, 4]', '[9, 1, 5, 4]', '[9, 8, 3, 4]', '[9, 1, 5, 4]', '[9, 7, 0, 0]',
        '[9, 1, 5, 5]', '[9, 1, 5, 5]', '[9, 1, 5, 5]', '[9, 1, 5, 5]', '[9, 1, 8, 0]'
    ]})
    assert all(len(loads(xxx)) == 4 for xxx in df_JSON_array_of_4xFixed_int.get_column("str").to_list())
    df_JSON_array_of_4xFixed_str = pl.DataFrame({"str": [
        '["9", "8", "4", "4"]', '["9", "1", "5", "4"]', '["9", "8", "3", "4"]', '["9", "1", "5", "4"]', '["9", "7", "0", "0"]',
        '["9", "1", "5", "5"]', '["9", "1", "5", "5"]', '["9", "1", "5", "5"]', '["9", "1", "5", "5"]', '["9", "1", "8", "0"]'
    ]})
    assert all(len(loads(xxx)) == 4 for xxx in df_JSON_array_of_4xFixed_str.get_column("str").to_list())
    df_JSON_array_of_Nx_JSON_object2 = pl.DataFrame({"str": [
        '[{"type": "x", "obj": 9}, {"type": "x", "obj": 8}, {"type": "x", "obj": 4}, {"type": "x", "obj": 4}]', '[{"type": "x", "obj": 9}, {"type": "x", "obj": 7}]', '[{"type": "x", "obj": 9}, {"type": "x", "obj": 1}, {"type": "x", "obj": 5}, {"type": "x", "obj": 4}]', '[{"type": "x", "obj": 9}, {"type": "x", "obj": 8}, {"type": "x", "obj": 3}, {"type": "x", "obj": 4}]', '[{"type": "x", "obj": 9}, {"type": "x", "obj": 1}, {"type": "x", "obj": 5}, {"type": "x", "obj": 4}]', '[{"type": "x", "obj": 1}]', '[{"type": "x", "obj": 9}, {"type": "x", "obj": 7}, {"type": "x", "obj": 0}, {"type": "x", "obj": 0}]',
        '[{"type": "y", "obj": 9}, {"type": "y", "obj": 1}, {"type": "y", "obj": 5}, {"type": "y", "obj": 5}, {"type": "y", "obj": 2}]', '[{"type": "y", "obj": 9}, {"type": "y", "obj": 1}, {"type": "y", "obj": 5}, {"type": "y", "obj": 5}, {"type": "y", "obj": 5}]', '[{"type": "y", "obj": 9}, {"type": "y", "obj": 1}, {"type": "y", "obj": 5}, {"type": "y", "obj": 5}, {"type": "y", "obj": 7}]', '[{"type": "y", "obj": 9}, {"type": "y", "obj": 1}, {"type": "y", "obj": 5}, {"type": "y", "obj": 5}, {"type": "y", "obj": 9}]', '[{"type": "y", "obj": 9}, {"type": "y", "obj": 1}, {"type": "y", "obj": 8}]'
    ]})
    assert all(all(len(xx) == 2 for xx in loads(xxx)) for xxx in df_JSON_array_of_Nx_JSON_object2.get_column("str").to_list())
    df_list_of_Nx_struct2 = pl.DataFrame({"list[struct[2]]": [
        [{"type": "x", "obj": 9}, {"type": "x", "obj": 8}, {"type": "x", "obj": 4}, {"type": "x", "obj": 4}], [{"type": "x", "obj": 9}, {"type": "x", "obj": 7}], [{"type": "x", "obj": 9}, {"type": "x", "obj": 1}, {"type": "x", "obj": 5}, {"type": "x", "obj": 4}], [{"type": "x", "obj": 9}, {"type": "x", "obj": 8}, {"type": "x", "obj": 3}, {"type": "x", "obj": 4}], [{"type": "x", "obj": 9}, {"type": "x", "obj": 1}, {"type": "x", "obj": 5}, {"type": "x", "obj": 4}], [{"type": "x", "obj": 1}], [{"type": "x", "obj": 9}, {"type": "x", "obj": 7}, {"type": "x", "obj": 0}, {"type": "x", "obj": 0}],
        [{"type": "y", "obj": 9}, {"type": "y", "obj": 1}, {"type": "y", "obj": 5}, {"type": "y", "obj": 5}, {"type": "y", "obj": 2}], [{"type": "y", "obj": 9}, {"type": "y", "obj": 1}, {"type": "y", "obj": 5}, {"type": "y", "obj": 5}, {"type": "y", "obj": 5}], [{"type": "y", "obj": 9}, {"type": "y", "obj": 1}, {"type": "y", "obj": 5}, {"type": "y", "obj": 5}, {"type": "y", "obj": 7}], [{"type": "y", "obj": 9}, {"type": "y", "obj": 1}, {"type": "y", "obj": 5}, {"type": "y", "obj": 5}, {"type": "y", "obj": 9}], [{"type": "y", "obj": 9}, {"type": "y", "obj": 1}, {"type": "y", "obj": 8}]
    ]})
    df_list_of_Nx_list2 = pl.DataFrame({"list[list[i64]]": [
        [[45, 9], [45, 8], [45, 4], [45, 4]], [[45, 9], [45, 7]], [[45, 9], [45, 1], [45, 5], [45, 4]], [[45, 9], [45, 8], [45, 3], [45, 4]], [[45, 9], [45, 1], [45, 5], [45, 4]], [[45, 1]], [[45, 9], [45, 7], [45, 0], [45, 0]],
        [[46, 9], [46, 1], [46, 5], [46, 5], [46, 2]], [[46, 9], [46, 1], [46, 5], [46, 5], [46, 5]], [[46, 9], [46, 1], [46, 5], [46, 5], [46, 7]], [[46, 9], [46, 1], [46, 5], [46, 5], [46, 9]], [[46, 9], [46, 1], [46, 8]]
    ]})
    df_list_of_Nx_array2 = df_list_of_Nx_list2.select(pl.col("list[list[i64]]").list.eval(pl.element().list.to_array(width=2)).alias("list[array[i64, 2]]"))

    del df_list_of_Nx_int, df_list_of_Nx_str, df_list_of_Nx_float, df_array_of_4xFixed_int, df_JSON_array_of_4xFixed_int, df_JSON_array_of_4xFixed_str, df_JSON_array_of_Nx_JSON_object2, df_list_of_Nx_struct2, df_list_of_Nx_list2, df_list_of_Nx_array2

    assert_frame_equal(
        pl.read_parquet(example_mvp).pipe(expand_model, verify_first_n=10_000).collect(),
        # from MVP to FULL model
        pl.DataFrame([
            pl.Series('p000_3', ['A1', 'A1', 'A1', 'A1', 'A1', 'A1', 'A1', 'A2', 'A2', 'A2', 'A2', 'A2', 'A2', 'Z', 'Y', 'Y', 'Y', 'Y', 'Y', 'Y'], dtype=pl.String),
            pl.Series('p001_3', [None, 'B', 'B', 'B', 'E', 'E', 'E', None, 'E', 'E', 'E', 'E', 'B', None, None, 'V', 'V', 'W', 'X', 'X'], dtype=pl.String),
            pl.Series('p002_3', [None, None, 'C', 'D', None, 'F', 'G', None, None, 'E', 'G', 'G', None, None, None, None, 'V', None, None, 'X'], dtype=pl.String),
            pl.Series('p003_3', [None, None, None, None, None, None, None, None, None, None, None, 'C', None, None, None, None, None, None, None, None], dtype=pl.String),
            pl.Series('v000_3', ['A1', ' ╠══➤ ', ' ║   ', ' ║   ', ' ╚══➤ ', '  ', '  ', 'A2', ' ╠══➤ ', ' ║   ', ' ║   ', ' ║   ', ' ╚══➤ ', 'Z', 'Y', ' ╠══➤ ', ' ║   ', ' ╠══➤ ', ' ╚══➤ ', '  '], dtype=pl.String),
            pl.Series('v001_3', ['  ', 'B', ' ╠══➤ ', ' ╚══➤ ', 'E', ' ╠══➤ ', ' ╚══➤ ', '  ', 'E', ' ╠══➤ ', ' ╚══➤ ', '  ', 'B', '  ', '  ', 'V', ' ╚══➤ ', 'W', 'X', ' ╚══➤ '], dtype=pl.String),
            pl.Series('v002_3', ['  ', '  ', 'C', 'D', '  ', 'F', 'G', '  ', '  ', 'E', 'G', ' ╚══➤ ', '  ', '  ', '  ', '  ', 'V', '  ', '  ', 'X'], dtype=pl.String),
            pl.Series('v003_3', ['  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', 'C', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  '], dtype=pl.String),
            pl.Series('cHead', ['A1', 'A1', 'A1', 'A1', 'A1', 'A1', 'A1', 'A2', 'A2', 'A2', 'A2', 'A2', 'A2', 'Z', 'Y', 'Y', 'Y', 'Y', 'Y', 'Y'], dtype=pl.String),
            pl.Series('cTail', ['A1', 'B', 'C', 'D', 'E', 'F', 'G', 'A2', 'E', 'E', 'G', 'C', 'B', 'Z', 'Y', 'V', 'V', 'W', 'X', 'X'], dtype=pl.String),
            pl.Series('cDepth', [0, 1, 2, 2, 1, 2, 2, 0, 1, 2, 2, 3, 1, 0, 0, 1, 2, 1, 1, 2], dtype=pl.UInt32),
            pl.Series('cStart', [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19], dtype=pl.UInt32),
            pl.Series('cStop', [7, 4, 3, 4, 7, 6, 7, 13, 12, 10, 12, 12, 13, 14, 20, 17, 17, 18, 20, 20], dtype=pl.UInt32),
            pl.Series('cSize', [7, 3, 1, 1, 3, 1, 1, 6, 4, 1, 2, 1, 1, 1, 6, 2, 1, 1, 2, 1], dtype=pl.UInt32),
            pl.Series('cWidth', [4, 7, 8, 8, 7, 8, 8, 4, 7, 8, 8, 1, 7, 4, 4, 7, 8, 7, 7, 8], dtype=pl.UInt32),
            pl.Series('cOut', [2, 2, 0, 0, 2, 0, 0, 2, 2, 0, 1, 0, 0, 0, 3, 1, 0, 0, 1, 0], dtype=pl.UInt32),
            pl.Series('cLeft', [1, 2, 3, 5, 8, 9, 11, 15, 16, 17, 19, 20, 24, 27, 29, 30, 31, 34, 36, 37], dtype=pl.UInt32),
            pl.Series('cRight', [14, 7, 4, 6, 13, 10, 12, 26, 23, 18, 22, 21, 25, 28, 40, 33, 32, 35, 39, 38], dtype=pl.UInt32),
            pl.Series('cIsRoot', [True, False, False, False, False, False, False, True, False, False, False, False, False, True, True, False, False, False, False, False], dtype=pl.Boolean),
            pl.Series('cIsLeaf', [False, False, True, True, False, True, True, False, False, True, False, True, True, True, False, False, True, True, False, True], dtype=pl.Boolean),
            pl.Series('user_value1', [None, None, 9.700000000000001, 9.700000000000001, None, 9.700000000000001, 9.700000000000001, None, None, 9.700000000000001, None, 9.600000000000001, 9.8, 9.9, None, None, 9.700000000000001, 9.8, None, 9.700000000000001], dtype=pl.Float64),
            pl.Series('user_value2', [4433021920397551.5, 663113530824211.6, 1.1602477287697392e+16, 4523479929846451.0, 1785059155888482.2, 8610132418777669.0, 1.7208435515317248e+16, 1.3663814735625294e+16, 3190232449575444.0, 8595718552375203.0, 3201171678032007.0, 3635924175750878.0, 1.2150902473689224e+16, 1.063393377393216e+16, 5500682402888033.0, 8615506271043085.0, 1771945185112145.8, 9244145388597298.0, 1.3577542752436462e+16, 8454898790149170.0], dtype=pl.Float64),
        ]),
        # self_test
        check_exact=True, check_row_order=True, check_column_order=True
    )
    assert_frame_equal(
        pl.read_parquet(example_mvp).pipe(expand_model, verify_first_n=10_000).select(~cs.starts_with("user_value")).collect(),
        # from MVP to FULL model
        pl.read_parquet(example_flat_one_ptr_column_all_nodes)
        .rename({"path-to-root": cptr})
        .pipe(from_mList).pipe(expand_model, verify_first_n=10_000).collect(),
        # from FLAT to FULL model
        check_exact=True, check_row_order=True, check_column_order=True
    )
    assert_frame_equal(
        pl.read_parquet(example_mvp).pipe(expand_model, verify_first_n=10_000).select(~cs.starts_with("user_value")).collect(),
        # from MVP to FULL model
        pl.read_parquet(example_flat_one_ptr_column_leaves_only)
        .rename({"path-to-root": cptr})
        .pipe(from_mList).pipe(refine_model).pipe(expand_model, verify_first_n=10_000).collect(),
        # from FLAT (leaves only example) to FULL model
        check_exact=True, check_row_order=True, check_column_order=True
    )
    assert_frame_equal(
        pl.read_parquet(example_mvp).pipe(expand_model, verify_first_n=10_000).select(~cs.starts_with("user_value")).collect(),
        # from MVP to FULL model
        pl.read_parquet(example_flat_one_ptr_column_problematic)
        .rename({"path-to-root": cptr})
        .pipe(from_mList).pipe(refine_model).pipe(expand_model, verify_first_n=10_000).collect(),
        # from FLAT (problematic example) to FULL model
        check_exact=True, check_row_order=True, check_column_order=True
    )
    assert_frame_equal(
        pl.read_parquet(example_mvp).pipe(expand_model, verify_first_n=10_000).collect(),
        # from MVP to FULL model
        pl.read_parquet(example_alist)
        .rename({"parent": cparent, "child": cchild, "business_key": cbkey})
        .pipe(from_mALPC).pipe(expand_model, verify_first_n=10_000).collect(),
        # from ALIST to FULL model
        check_exact=True, check_row_order=True, check_column_order=True
    )

    for (prev_a, prev_b), (cur_a, cur_b) in pairwise(chain(
        [(None, None)],
        combinations(pl.read_parquet(example_full_many_permutations).get_column('PERMUTATION_ID').unique().sort().to_list(), 2)
    )):
        df_a = pl.read_parquet(example_full_many_permutations).filter(pl.col('PERMUTATION_ID').eq(cur_a)).select(chead, ctail, cdepth, cstart, cstop) if prev_a != cur_a else df_a
        df_b = pl.read_parquet(example_full_many_permutations).filter(pl.col('PERMUTATION_ID').eq(cur_b)).select(chead, ctail, cdepth, cstart, cstop) if prev_b != cur_b else df_b
        assert (not df_a.equals(df_b)) and test_equal(df_a, df_b)
        print(f"{cur_a:03}   {cur_b:03}")

    for mvp_model, lf in (
        (example_mvp, pl.scan_parquet(example_mvp).select(ctail, cdepth)),
        (unit_test_aa_mvp, pl.scan_parquet(unit_test_aa_mvp).select(ctail, cdepth)),
        (unit_test_bb_mvp, pl.scan_parquet(unit_test_bb_mvp).select(ctail, cdepth)),
        (unit_test_cc_mvp, pl.scan_parquet(unit_test_cc_mvp).select(ctail, cdepth))
    ):
        print(f"\n\n{mvp_model}\n", lf.pipe(expand_model, verify_first_n=10_000).select(~cs_ptr).explain(optimized=True))
        df: pl.DataFrame = lf.pipe(expand_model, verify_first_n=10_000).select(~cs_ptr).collect()
        assert_frame_equal(lf.collect(), df.select(ctail, cdepth),
            check_exact=True, check_row_order=True, check_column_order=True
        )
        db.sql(f"""SUMMARIZE df;""").show(max_rows=200, max_width=5_000)
        db.sql(f"""SELECT * FROM df;""").show(max_rows=50, max_width=5_000)

    print(f"\n\nNO ERRORS detected\n\n")
